# <a name="how-the-office-javascript-api-documentation-is-generated"></a><span data-ttu-id="878f3-101">Cómo se genera la documentación de la API de JavaScript para Office</span><span class="sxs-lookup"><span data-stu-id="878f3-101">How the Office JavaScript API documentation is generated</span></span>

<span data-ttu-id="878f3-102">Las páginas de documentación de referencia de JavaScript de Office se generan a partir de archivos de definición de tipo y fragmentos de código de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="878f3-102">The Office JavaScript reference documentation pages are generated from type definition files and example snippets.</span></span> <span data-ttu-id="878f3-103">Este proceso utiliza una combinación de herramientas de código abierto y scripts específicos del repositorio.</span><span class="sxs-lookup"><span data-stu-id="878f3-103">This process uses a blend of open source tools and repository-specific scripts.</span></span> <span data-ttu-id="878f3-104">Este documento tiene como objetivo hacer que los procesos de este repositorio sean transparentes, de modo que la comunidad pueda beneficiarse mejor de este contenido y contribuir a él.</span><span class="sxs-lookup"><span data-stu-id="878f3-104">This document aims to make the processes of this repository transparent so the community can better benefit from and contribute to this content.</span></span>

## <a name="content-sources"></a><span data-ttu-id="878f3-105">Orígenes de contenido</span><span class="sxs-lookup"><span data-stu-id="878f3-105">Content sources</span></span>

<span data-ttu-id="878f3-106">Se combinan dos tipos de contenido para crear la documentación de referencia de Office-JS: definiciones de tipo y fragmentos de código.</span><span class="sxs-lookup"><span data-stu-id="878f3-106">Two types of content are combined to create the Office-JS reference documentation: type definitions and code snippets.</span></span> <span data-ttu-id="878f3-107">Esto garantiza una cobertura completa de la API y proporciona ejemplos pequeños de código en línea.</span><span class="sxs-lookup"><span data-stu-id="878f3-107">These ensure complete API coverage and give small, inline code samples.</span></span>

### <a name="type-definition-files"></a><span data-ttu-id="878f3-108">Archivos de definición de tipo</span><span class="sxs-lookup"><span data-stu-id="878f3-108">Type definition files</span></span>

<span data-ttu-id="878f3-109">Los archivos de definición de tipo en [tipos indefinidos](https://github.com/DefinitelyTyped/DefinitelyTyped) son el único origen de verdad para la documentación.</span><span class="sxs-lookup"><span data-stu-id="878f3-109">The type definition files on [Definitely Typed](https://github.com/DefinitelyTyped/DefinitelyTyped) are the single source of truth for the documentation.</span></span> <span data-ttu-id="878f3-110">Cualquier complemento de Office que usa TypeScript compila con estos archivos de definición de tipo.</span><span class="sxs-lookup"><span data-stu-id="878f3-110">Any Office Add-in that uses TypeScript compiles by using these type definition files.</span></span> <span data-ttu-id="878f3-111">También ofrece capacidades de IntelliSense de JavaScript y TypeScript para desarrolladores.</span><span class="sxs-lookup"><span data-stu-id="878f3-111">These also give JavaScript and TypeScript developers IntelliSense capabilities.</span></span> <span data-ttu-id="878f3-112">Al crear la documentación de referencia a partir de estas definiciones, proporcionamos información más precisa.</span><span class="sxs-lookup"><span data-stu-id="878f3-112">By building the reference documentation from these definitions, we provide more accurate information.</span></span>

<span data-ttu-id="878f3-113">Hay cuatro archivos d. ts relevantes que proporcionan contenido de origen para diferentes subsecciones de los documentos.</span><span class="sxs-lookup"><span data-stu-id="878f3-113">There are four relevant d.ts files that provide source content for different subsections of the docs.</span></span>

- <span data-ttu-id="878f3-114">[Office-js/index. d. ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (las definiciones de la versión).</span><span class="sxs-lookup"><span data-stu-id="878f3-114">[office-js/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js/index.d.ts) (The Release definitions.)</span></span>
  - [<span data-ttu-id="878f3-115">Excel (versión)</span><span class="sxs-lookup"><span data-stu-id="878f3-115">Excel (Release)</span></span>](https://docs.microsoft.com/javascript/api/excel_release)
  - [<span data-ttu-id="878f3-116">OneNote</span><span class="sxs-lookup"><span data-stu-id="878f3-116">OneNote</span></span>](https://docs.microsoft.com/javascript/api/onenote)
  - [<span data-ttu-id="878f3-117">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="878f3-117">PowerPoint</span></span>](https://docs.microsoft.com/javascript/api/powerpoint)
  - [<span data-ttu-id="878f3-118">Visio</span><span class="sxs-lookup"><span data-stu-id="878f3-118">Visio</span></span>](https://docs.microsoft.com/javascript/api/visio)
  - [<span data-ttu-id="878f3-119">Word (versión)</span><span class="sxs-lookup"><span data-stu-id="878f3-119">Word (Release)</span></span>](https://docs.microsoft.com/javascript/api/word_release)
  - [<span data-ttu-id="878f3-120">Subsección OfficeExtensions de la API común</span><span class="sxs-lookup"><span data-stu-id="878f3-120">OfficeExtensions subsection of the Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="878f3-121">[Office-js-Preview/index. d. ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (las definiciones de vista previa).</span><span class="sxs-lookup"><span data-stu-id="878f3-121">[office-js-preview/index.d.ts](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts) (The Preview definitions.)</span></span>
  - [<span data-ttu-id="878f3-122">Excel (versión preliminar)</span><span class="sxs-lookup"><span data-stu-id="878f3-122">Excel (Preview)</span></span>](https://docs.microsoft.com/javascript/api/excel)
  - [<span data-ttu-id="878f3-123">Outlook (versión preliminar)</span><span class="sxs-lookup"><span data-stu-id="878f3-123">Outlook (Preview)</span></span>](https://docs.microsoft.com/javascript/api/outlook)
  - [<span data-ttu-id="878f3-124">Word (vista previa)</span><span class="sxs-lookup"><span data-stu-id="878f3-124">Word (Preview)</span></span>](https://docs.microsoft.com/javascript/api/word)
  - [<span data-ttu-id="878f3-125">API común</span><span class="sxs-lookup"><span data-stu-id="878f3-125">Common API</span></span>](https://docs.microsoft.com/javascript/api/office)
- <span data-ttu-id="878f3-126">[Custom-Functions-Runtime/index. d. ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (las definiciones en tiempo de ejecución de las funciones personalizadas de Excel).</span><span class="sxs-lookup"><span data-stu-id="878f3-126">[custom-functions-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/custom-functions-runtime/index.d.ts) (The Excel Custom Functions runtime definitions.)</span></span>
  - [<span data-ttu-id="878f3-127">Funciones personalizadas</span><span class="sxs-lookup"><span data-stu-id="878f3-127">Custom Functions</span></span>](https://docs.microsoft.com/javascript/api/custom-functions-runtime)
- <span data-ttu-id="878f3-128">[Office-Runtime/index. d. ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (las definiciones en tiempo de ejecución de Office para la plataforma de funciones personalizadas).</span><span class="sxs-lookup"><span data-stu-id="878f3-128">[office-runtime/index.d.ts](https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/office-runtime/index.d.ts) (The office runtime definitions for the Custom Functions platform.)</span></span>
  - [<span data-ttu-id="878f3-129">Tiempo de ejecución de Office</span><span class="sxs-lookup"><span data-stu-id="878f3-129">Office Runtime</span></span>](https://docs.microsoft.com/javascript/api/office-runtime)

<span data-ttu-id="878f3-130">Las versiones anteriores de las API tienen sus propios archivos d. TS.</span><span class="sxs-lookup"><span data-stu-id="878f3-130">Older versions of the APIs have their own d.ts files.</span></span> <span data-ttu-id="878f3-131">Se conservan cuando se publica un nuevo conjunto de requisitos de la API.</span><span class="sxs-lookup"><span data-stu-id="878f3-131">These are preserved when a new API requirement set is released.</span></span> <span data-ttu-id="878f3-132">También pueden generarse con la [herramienta de descambio de versión](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span><span class="sxs-lookup"><span data-stu-id="878f3-132">They can also be generated using the [Version Remover tool](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/tools/VersionRemover.ts).</span></span> <span data-ttu-id="878f3-133">Estos archivos d. ts antiguos se mantienen para que, en las API de evento se revisen o modifiquen, el comportamiento original sigue estando documentado.</span><span class="sxs-lookup"><span data-stu-id="878f3-133">These old d.ts files are maintained so that in the event APIs are patched or altered, the original behavior is still documented.</span></span> <span data-ttu-id="878f3-134">Esto es útil si tiene que dirigirse a una versión anterior de la API.</span><span class="sxs-lookup"><span data-stu-id="878f3-134">This is useful if you have to target an older version of the API.</span></span>

#### <a name="testing-type-definition-file-changes"></a><span data-ttu-id="878f3-135">Prueba de cambios en el archivo de definición de tipo</span><span class="sxs-lookup"><span data-stu-id="878f3-135">Testing type definition file changes</span></span>

<span data-ttu-id="878f3-136">Los cambios en la documentación de la API de JavaScript para Office se realizan editando los cuatro archivos d. ts mencionados anteriormente.</span><span class="sxs-lookup"><span data-stu-id="878f3-136">Any documentation changes for the Office JavaScript API are done by editing the four d.ts files mentioned above.</span></span> <span data-ttu-id="878f3-137">Sin embargo, puede probar un cambio antes de enviar un PR a DefinitelyTyped (si, por ejemplo, debe probar cómo se traducirá el formato en Markdown) editando el archivo correspondiente en [generar-docs/script-INPUTS](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) y ejecutando [GenerateDocs. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span><span class="sxs-lookup"><span data-stu-id="878f3-137">However, you can test a change before submitting a PR to DefinitelyTyped (if you need to, for example, test how your formatting will translate into markdown) by editing the corresponding file in [generate-docs/script-inputs](https://github.com/OfficeDev/office-js-docs-reference/tree/master/generate-docs/script-inputs) and running [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd).</span></span> <span data-ttu-id="878f3-138">Cuando se le pida, seleccione la opción "archivos locales".</span><span class="sxs-lookup"><span data-stu-id="878f3-138">When prompted, select the "Local files" option.</span></span>

<span data-ttu-id="878f3-139">Al insertar los cambios en una rama remota de este repositorio, la plataforma docs.microsoft.com crea una bifurcación de prueba.</span><span class="sxs-lookup"><span data-stu-id="878f3-139">Pushing changes to a remote branch of this repo causes the docs.microsoft.com platform to build a test branch.</span></span> <span data-ttu-id="878f3-140">Esta rama se representa en review.docs.microsoft.com, a la que solo tiene acceso el personal interno de Microsoft.</span><span class="sxs-lookup"><span data-stu-id="878f3-140">This branch is rendered on review.docs.microsoft.com, which is only accessible by internal Microsoft personnel.</span></span> <span data-ttu-id="878f3-141">Cualquier persona que revise el PR, comprobará la precisión del sitio de revisión.</span><span class="sxs-lookup"><span data-stu-id="878f3-141">Anyone reviewing your PR will check the review site for accuracy.</span></span>

### <a name="code-snippets"></a><span data-ttu-id="878f3-142">Fragmentos de código</span><span class="sxs-lookup"><span data-stu-id="878f3-142">Code snippets</span></span>

<span data-ttu-id="878f3-143">Se agregan fragmentos de código de ejemplo a las páginas de referencia de dos orígenes:</span><span class="sxs-lookup"><span data-stu-id="878f3-143">Code example snippets are added to the reference pages from two sources:</span></span>

- [<span data-ttu-id="878f3-144">Ejemplos del laboratorio de scripts</span><span class="sxs-lookup"><span data-stu-id="878f3-144">Script Lab Samples</span></span>](https://github.com/OfficeDev/office-js-snippets)
- [<span data-ttu-id="878f3-145">Fragmentos de código locales</span><span class="sxs-lookup"><span data-stu-id="878f3-145">Local Code Snippets</span></span>](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/code-snippets)

<span data-ttu-id="878f3-146">Los fragmentos de código locales se encuentran en archivos YAML específicos del host.</span><span class="sxs-lookup"><span data-stu-id="878f3-146">The local snippets are in host-specific yaml files.</span></span> <span data-ttu-id="878f3-147">El contenido se organiza por clase y campo, por lo que se puede asignar al espacio adecuado en una página de referencia.</span><span class="sxs-lookup"><span data-stu-id="878f3-147">Their content is organized by class and field, so it can be mapped to the appropriate place in a reference page.</span></span> <span data-ttu-id="878f3-148">El idioma del fragmento de código (JavaScript o TypeScript) se deduce mediante el uso de instrucciones Await.</span><span class="sxs-lookup"><span data-stu-id="878f3-148">The language of the snippet (JavaScript or TypeScript) is inferred by the use of await statements.</span></span>

<span data-ttu-id="878f3-149">Los fragmentos de código del laboratorio de scripts se extraen de las muestras de trabajo.</span><span class="sxs-lookup"><span data-stu-id="878f3-149">The Script Lab snippets are pulled from working samples.</span></span> <span data-ttu-id="878f3-150">Actualmente, los ejemplos de Excel, Outlook y Word se asignan para hacer referencia a secciones de documento mediante [archivos de asignación](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span><span class="sxs-lookup"><span data-stu-id="878f3-150">Currently, Excel, Outlook, and Word samples are mapped to reference document sections through [mapping files](https://github.com/OfficeDev/office-js-snippets/tree/master/snippet-extractor-metadata).</span></span> <span data-ttu-id="878f3-151">Estos métodos de ejemplo individuales coinciden con las propiedades o los métodos de la API.</span><span class="sxs-lookup"><span data-stu-id="878f3-151">These match individual sample methods to properties or methods in the API.</span></span> <span data-ttu-id="878f3-152">Cuando se ejecuta el repositorio Office-js-Snippets `yarn start` , se crea [un archivo YAML](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) que contiene todos los fragmentos de código asignados.</span><span class="sxs-lookup"><span data-stu-id="878f3-152">When the office-js-snippets repository's `yarn start` runs, [a yaml file](https://github.com/OfficeDev/office-js-snippets/blob/master/snippet-extractor-output/snippets.yaml) containing all the mapped snippets is created.</span></span> <span data-ttu-id="878f3-153">Este archivo YAML es la entrada en la herramienta de documentación de referencia.</span><span class="sxs-lookup"><span data-stu-id="878f3-153">This yaml file is the input into the reference documentation tooling.</span></span>

## <a name="tooling-pipeline"></a><span data-ttu-id="878f3-154">Canalización de herramientas</span><span class="sxs-lookup"><span data-stu-id="878f3-154">Tooling pipeline</span></span>

![Una imagen que muestra el flujo de control de tipo definido de forma indefinida, al preprocesador, extractor de API, procesador, documentador de API y a a través del postprocesador.](ToolingPipeline.png)

<span data-ttu-id="878f3-156">Entre los orígenes de contenido y las páginas finales, el contenido de la documentación pasa por cinco pasos de herramientas:</span><span class="sxs-lookup"><span data-stu-id="878f3-156">Between the content sources and the final pages, the documentation content goes through five tooling steps:</span></span>

1. [<span data-ttu-id="878f3-157">Script de preprocesador</span><span class="sxs-lookup"><span data-stu-id="878f3-157">Preprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/preprocessor.ts)
1. [<span data-ttu-id="878f3-158">Extractor de API</span><span class="sxs-lookup"><span data-stu-id="878f3-158">API Extractor</span></span>](https://api-extractor.com/)
1. [<span data-ttu-id="878f3-159">Script de procesador</span><span class="sxs-lookup"><span data-stu-id="878f3-159">Midprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/midprocessor.ts)
1. [<span data-ttu-id="878f3-160">Documentador de la API</span><span class="sxs-lookup"><span data-stu-id="878f3-160">API Documenter</span></span>](https://github.com/microsoft/rushstack/blob/master/apps/api-documenter/README.md)
1. [<span data-ttu-id="878f3-161">Script de postprocesador</span><span class="sxs-lookup"><span data-stu-id="878f3-161">Postprocessor script</span></span>](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/scripts/postprocessor.ts)

<span data-ttu-id="878f3-162">El preprocesador toma los archivos d. TS y los divide en secciones específicas de host.</span><span class="sxs-lookup"><span data-stu-id="878f3-162">The preprocessor takes the d.ts files and splits them into host-specific sections.</span></span> <span data-ttu-id="878f3-163">Lleva a cabo las operaciones de limpieza necesarias para las herramientas siguientes para procesar los datos correctamente.</span><span class="sxs-lookup"><span data-stu-id="878f3-163">It performs any cleanup necessary for the subsequent tools to properly process the data.</span></span>

<span data-ttu-id="878f3-164">El extractor de API convierte los archivos d. TS en datos JSON.</span><span class="sxs-lookup"><span data-stu-id="878f3-164">API Extractor converts the d.ts files into JSON data.</span></span> <span data-ttu-id="878f3-165">Esto tokenizes todos los datos de tipo, lo que permite un análisis más sencillo.</span><span class="sxs-lookup"><span data-stu-id="878f3-165">This tokenizes all the type data, allowing for easier parsing.</span></span>

<span data-ttu-id="878f3-166">El procesador es el que recupera los fragmentos de código y los empareja con los hosts adecuados y limpia el vínculo cruzado entre Outlook y los objetos de la API comunes.</span><span class="sxs-lookup"><span data-stu-id="878f3-166">The midprocessor retrieves the code snippets and pairs them with the proper hosts, and cleans up the crosslinking between Outlook and Common API objects.</span></span>

<span data-ttu-id="878f3-167">El Documentador de la API convierte los datos JSON en archivos. yml.</span><span class="sxs-lookup"><span data-stu-id="878f3-167">API Documenter converts the JSON data into .yml files.</span></span> <span data-ttu-id="878f3-168">Los archivos. yml se convierten en Markdown por el sistema de publicación abierto que publica nuestros documentos en docs.microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="878f3-168">The .yml files are converted to markdown by the Open Publishing System that publishes our docs to docs.microsoft.com.</span></span> <span data-ttu-id="878f3-169">El Documentador de la API también contiene una extensión específica de Office que inserta los fragmentos de código.</span><span class="sxs-lookup"><span data-stu-id="878f3-169">API Documenter also contains an Office-specific extension that inserts our code snippets.</span></span>

<span data-ttu-id="878f3-170">El postprocesador limpia la tabla de contenido y mueve los archivos. yml a la carpeta de [publicación](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span><span class="sxs-lookup"><span data-stu-id="878f3-170">The postprocessor cleans up the table of contents and moves the .yml files into the [publishing folder](https://github.com/OfficeDev/office-js-docs-reference/tree/master/docs/docs-ref-autogen).</span></span>

<span data-ttu-id="878f3-171">Estos cinco pasos se llevan a cabo cuando se ejecuta [GenerateDocs. cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) .</span><span class="sxs-lookup"><span data-stu-id="878f3-171">All five of these steps are performed when [GenerateDocs.cmd](https://github.com/OfficeDev/office-js-docs-reference/blob/master/generate-docs/GenerateDocs.cmd) is run.</span></span> <span data-ttu-id="878f3-172">Ese script también controla la instalación del módulo de nodo, limpia los conjuntos de archivos antiguos y los archivos de definición de tipo de versiones para cada conjunto de requisitos.</span><span class="sxs-lookup"><span data-stu-id="878f3-172">That script also handles node module installation, cleans out old file sets, and versions Type Definition files for each requirement set.</span></span>
